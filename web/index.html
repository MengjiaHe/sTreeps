<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>jotoko</title>
	<script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js'></script>
	<script type="text/javascript" src="js/jquery.path.js"></script>
	<script src="lib/goo-require.js"></script>
		<script src="js/loadScene.js"></script>
	<link type="text/css" href="css/main.css" rel="stylesheet"></link>
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<script>
		jQuery(function() {
			new sTreepsJS(jQuery); 
		})
		var sTreepsJS = (function($) {
			var _scrollTop = 0,
				_currentText = 0,
				_textDivs,
				_currentPath = 0,
				_beePath = [
					{
						x: 0,
						y: 0,
						angle: 315.012,
						length: 0.707
					},
					{
						x: 50,
						y: 10,
						angle: 315.012,
						length: 0.707
					},
					{
						x: -80,
						y: 50,
						angle: 315.012,
						length: 0.707
					},
					{
						x: 20,
						y: 20,
						angle: 315.012,
						length: 0.707
					}
				],
				_hotSpot = [
					{
						x: -200,
						y: 200
					},
					{
						x: 200,
						y: 600
					},
					{
						x: -600,
						y: 900
					}
				],
				_path = {
					start: undefined,
					end: AddHotSpot(Clone(_beePath[0]))
				};


			function Init() {
				SetJQueryBindings();
				Animate();
			}

			function SetJQueryBindings() {
				$(window).scroll(OnScroll);
				_textDivs = $(".mainPost");
			}

			function Animate() {
				_currentPath = (_currentPath + 1)%_beePath.length;

				_path.start = _path.end;
				_path.end = Clone(_beePath[_currentPath]);

				AddHotSpot(_path.end);
				console.log(_path.start.x + " " + _path.start.y);

				$('#bee').animate({
				    path : new $.path.bezier(_path)
				}, 2000, Animate);
			}

			function Clone(obj) {
			    if (null == obj || "object" != typeof obj) return obj;
			    var copy = obj.constructor();
			    for (var attr in obj) {
			        if (obj.hasOwnProperty(attr)) copy[attr] = obj[attr];
			    }

			    return copy;
			}

			function AddHotSpot(position) {
				var hotSpotPosition = _hotSpot[_currentText];

				position.x += hotSpotPosition.x;
				position.y += hotSpotPosition.y;

				return position;
			}

			
			function OnScroll(scroll) {
				var top = $("body").scrollTop();
				var deltaScroll = top - _scrollTop;

				$("#header").toggleClass("minimized", top > 0);

				var infoText = $("#infoText");
				var topOffset = infoText.offset().top;
				var bottomOffset = topOffset + infoText.height();
				var streepsLogo = $("#streepsLogo>img");
				var bee = $("#bee");

				if (deltaScroll > 0) {
					if (_currentText <= _textDivs.length)
						if ($(_textDivs[_currentText + 1]).offset().top < topOffset) {
							_currentText += 1;
						}
				} else {
					if ($(_textDivs[_currentText]).offset().top > bottomOffset) {
						_currentText -= 1;
					}
				}

				_scrollTop = top;
				streepsLogo.css('padding-top', Math.abs(bottomOffset - streepsLogo.offset().top + streepsLogo.height()));
				infoText.html(_textDivs[_currentText].getAttribute('data-text'));
			}

			Init();
		});
	</script>
</head>
<body>
<div id="mainContainer">
	<div id="header">
		<div>
			<div id="logo" class="w25100 logo">
			</div>
			<div id="navbar" class="w75100">
				<ul class="ch-grid">
					<li>
						<div class="ch-item ch-img-3">
							<div class="ch-info">
								<p>Media</p>
							</div>
						</div>
					</li>
					<li>
						<div class="ch-item ch-img-2">
							<div class="ch-info">
								<p>Blog</p>
							</div>
						</div>
					</li>
					<li>
						<div class="ch-item ch-img-1">
							<div class="ch-info">
								<p>Mix and match</p>
							</div>
						</div>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<div id="container">
		<div id="infoText"> 
			These are not normal trees.
		</div>
		<div id="strip1" class="green mainPost" data-text="These are not normal trees.">
		</div>
		<div id="strip2" class="yellow mainPost" data-text="Mix the strips to see <br> the world change.">
		</div>
		<div id="strip3" class="blue mainPost" data-text="available when it is done :)">
		</div>
		<div id="strip4" class="red mainPost">
			<div id="streepsLogo">
				<img src="img/logo.png">
			</div>
		</div>
		<div id="bee">
			<img src="img/bee_body.png">
		</div>
	</div>
	<div id="footer">
		<div>
			<div class="media vpadding">
				<span class="icon-stack icon-2x facebookColor clickable">
				  <i class="icon-circle icon-stack-base"></i>
				  <i class="icon-facebook icon-light icon-overlay"></i>
				</span>
				<span class="icon-stack icon-2x googlePlusColor clickable">
				  <i class="icon-circle icon-stack-base"></i>
				  <i class="icon-google-plus icon-light icon-overlay"></i>
				</span>
				<span class="icon-stack icon-2x twitterColor clickable">
				  <i class="icon-circle icon-stack-base"></i>
				  <i class="icon-twitter icon-light icon-overlay"></i>
				</span>
				<span class="icon-stack icon-2x instagramColor clickable">
				  <i class="icon-circle icon-stack-base"></i>
				  <i class="icon-instagram icon-light icon-overlay"></i>
				</span>
				<span class="icon-stack icon-2x pinterestColor clickable">
				  <i class="icon-circle icon-stack-base"></i>
				  <i class="icon-pinterest icon-light icon-overlay"></i>
				</span>
				<span class="icon-stack icon-2x tumblrColor clickable">
				  <i class="icon-circle icon-stack-base"></i>
				  <i class="icon-tumblr icon-light icon-overlay"></i>
				</span>
			</div>
		</div>
	</div>
</div>

</body>
</html>